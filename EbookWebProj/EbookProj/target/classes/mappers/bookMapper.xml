<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.spring.acorn.mapper.book">
 	<select id="list" resultType="book">
 	 	SELECT	BOOKNUM, TITLE, GENRENUM, AUTHOR, CONTENT, LIKECNT
 		FROM	BOOKINFO
 	</select>
 	
 	<select id="recom" resultType="recomlist">
 		SELECT		BOOKNUM, TITLE, GENRENUM
		FROM		BOOKINFO 
		WHERE		GENRENUM IN (	SELECT REGEXP_SUBSTR(U.CONT, <![CDATA[ '[^|]+' ]]>, 1, LEVEL) CONT
													FROM (SELECT GENRENUM CONT
																FROM USERINFO
																WHERE USERID =   )U
													CONNECT BY LEVEL <![CDATA[ <=   ]]> length(REGEXP_REPLACE(U.CONT, '[^|]+',''))+1)
 	
 	</select>
 	
</mapper>

